from matplotlib import pyplot as plt

from Costs import Costs
from Grid import Grid
from Parameters import Parameters
from ResultsAnalyzer import ResultsAnalyzer
from Simulation import Simulation


def main():
    # Define parameters
    parameters = Parameters(beta1=0.05, beta2=0.005, gamma=0.02, epsilon1=2.0, epsilon2=0.475)

    # Initialize costs
    costs = Costs(c_A=0, c_S=0, c_I=0, c_R=0, c_SI=1, c_SA=1, c_AS=1, c_AI=1, c_IR=1)

    # Create a Grid instance
    grid = Grid(size=30, parameters=parameters, costs=costs)

    # Create a Simulation instance
    simulation = Simulation(grid, num_runs=10, num_time_steps=800)

    # Run the simulation and collect results
    infected_percentages, vulnerable_percentages, total_costs = simulation.run_simulation(show_plot=False)

    # Create a ResultsAnalyzer instance
    analyzer = ResultsAnalyzer(infected_percentages, vulnerable_percentages)

    # Calculate and print average percentages
    avg_infected, avg_vulnerable = analyzer.average_percentages_over_time()
    analyzer.plot_results(avg_infected, avg_vulnerable)


if __name__ == "__main__":
    main()
